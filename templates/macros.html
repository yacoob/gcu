{# vim: set tw=0 ft=jinja: #}
{% macro thumb(href) -%}
{{ config.extra.photo_thumb ~ href }}
{%- endmacro thumb %}

{% macro full(href) -%}
{{ config.extra.photo_full ~ href  }}
{%- endmacro full %}

{% macro cover(thing) -%}
<img class='img-rounded img-responsive' src='{{ self::thumb(href=thing.extra.cover) }}'>
{%- endmacro cover %}

{% macro title_row(title, url) -%}
<div class='col-sm-12 col-md-8 text-right'>
  <h1 class='title'><a href='{{ url|safe }}'>{{ title }}</a></h1>
</div> <!-- column -->
{%- endmacro %}

{% macro kit_cover(kit, width=3) -%}
<div class='col-xs-12 col-sm-4 col-md-{{ width }} text-center'>
  <div class='model'>
    {{ self::cover(thing=kit) }}
    <div class='overlay'>
      <a href='{{ self::kit_link(kit=kit) }}'></a>
      <h3>{{ self::kit_title(kit=kit) }}</h3>
    </div>
  </div>
</div>
{%- endmacro kit_cover %}

{% macro kit_link(kit) -%}
{% if kit.relative_path is ending_with('_index.md') -%}
/{{ kit.path }}
{%- else -%}
/{{ kit.path|split(pat="/")|slice(end=2)|join(sep="/")|safe }}/#{{ kit.date }}
{%- endif -%}
{%- endmacro kit_link %}

{% macro kit_title(kit) -%}
{% if kit.relative_path is ending_with('_index.md') -%}
{% else -%}
  {% set kit = get_section(path=kit.ancestors.2) -%}
{% endif -%}
{{ kit.title }}
{%- endmacro kit_title %}


{% macro photo(p) -%}
{%- set src = p.thumb|default(value=p.href) -%}
{%- set title = p.title|default(value="") -%}
<img width=185 src="{{ self::thumb(href=src) }}" title="{{ title }}" description="{{ title }}" />
{%- endmacro photo -%}
